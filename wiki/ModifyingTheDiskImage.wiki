#summary Developer Note: Modifying the Disk Image
#labels Phase-Implementation

Starting with Build 1326, The contents of the dmgFiles folder are used to create the .dmg file used
to distribute Tunnelblick. They provide view options, icon positions, and
a background image that is displayed when the .dmg file is opened.

The "dotDS_Store" file is a .DS_Store file copied from a volume which has
icons positioned and view attributes and a background set up the way we
want the Tunnelblick .dmg. The file is copied to the staging folder as
.DS_Store, and the copy in the staging folder is set to be invisible in
the Finder, before the .dmg is created from the staging folder.

The "background" folder contains the "background.png" file which is used
as a background for the .dmg when it is opened in the Finder. The folder
and its contents are copied to the staging folder, and the copy of the
folder in the staging folder is set to be invisible in the Finder, before
the .dmg is created from the staging folder.

"background.rtf" provides an easy way to create the text-based background
image. It is an RTF document which can be easily edited in SimpleText. A
screenshot of it is taken to provide the "background.png" file that is
used as a background image when the .dmg is opened in the Finder. This is
done so that additional translations can be added, corrections made, etc.
(Don't forget to turn off spell checking in SimpleText when taking the
screenshot, so wavy red underlines don't appear in it!)

==MODIFYING THE BACKGROUND IMAGE==

To modify the background image, simply edit "background.rtf", take a
screenshot (using Command-Shift-4) starting from the upper-left corner of
the editing window, rename the screenshot to "background.png", and copy it
into dmgFiles/background (overwriting the old version).

==ADDING/REMOVING CONTENT OR MODIFYING THE LAYOUT OF ICONS OR VIEW OPTIONS==

Modifying view options, the layout of the icons, or adding or removing
content/icons is more complicated:

# Use Disk Utility to convert Tunnelblick.dmg to read/write image named "TunnelblickRW.dmg". ("Convert" creates a new copy without disturbing the original.)
  # Double-click the read-write image and then double-click the resulting Tunnelblick volume to open a window for it in the Finder.
  # Manipulate the window to add or remove files, change view options and icon positions, etc. as desired.
  # Close the window.
  # Eject the Tunnelblick volume, and then log out and log back in again or restart your computer. (The logout/login or restart seems to be necessary to flush the Finder's cache of data to the the .DS_Store file on the volume.)
  # Use Disk Utility to convert TunnelblickRW.dmg to a "compressed" disk image named "TunnelblickC.dmg".
  # Double-click TunnelblickC.dmg and verify that the window layout, view options, etc. are as desired.
  # Use the following Terminal commands to (A) copy the volume's .DS_Store file and (B) make it visible. (Drag and drop a folder icon anywhere in to the Terminal window to insert the absolute path to that folder at the Terminal window's insertion point.)
{{{
     cp -p /Volumes/Tunnelblick/.DS_Store PATH-TO-THE-dmgFiles-FOLDER/dotDSStore

     setfile -a -v PATH-TO-THE-dmgFiles-FOLDER/dotDSStore
}}}